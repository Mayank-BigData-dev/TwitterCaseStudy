import com.caseStudy.SparkKafkaConnect.SparkKafkaConnect
import org.junit.Test


class SparkKafkaConnectTest
{

  @Test def test_SparkKafkaConnect_cleanLocation(){

        val unfilteredLocation1 = "Chennai,India"
        val unfilteredLocation2 = "Punjab ,IN"
        val unfilteredLocation3 = "IN"
        val unfilteredLocation4 = "indian"

        assert("India"==SparkKafkaConnect.cleaningLocation(unfilteredLocation1))
        assert("India"==SparkKafkaConnect.cleaningLocation(unfilteredLocation2))
        assert("India"==SparkKafkaConnect.cleaningLocation(unfilteredLocation3))
        assert("India"!=SparkKafkaConnect.cleaningLocation(unfilteredLocation4))
  }

  @Test def test_SparkKafkaConnect_extractData(): Unit =
  {
      val dataLine1 = "{\"created_at\":\"Mon Apr 06 18:40:35 +0000 2020\",\"id\":1247232754074423297,\"id_str\":\"1247232754074423297\",\"text\":\"RT @lloyd4man: Coronavirus Jailbreak: Soros-Funded ACLU Helps Free Illegal Alien Child Molester, Immigrant Child Abuser - Trump Train https\\u2026\",\"source\":\"\\u003ca href=\\\"https:\\/\\/mobile.twitter.com\\\" rel=\\\"nofollow\\\"\\u003eTwitter Web App\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":88245184,\"id_str\":\"88245184\",\"name\":\"misslexi China Is Asshoe...\",\"screen_name\":\"misslexi9162\",\"location\":\"US\",\"url\":null,\"description\":\"troublemaker. PSYOPs #gringoarmy. Senior Fellow of Bacon per@RBPundit. Don't bother - I just block trolls https:\\/\\/gab.com\\/misslexi9162\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":3498,\"friends_count\":1713,\"listed_count\":42,\"favourites_count\":262247,\"statuses_count\":274015,\"created_at\":\"Sat Nov 07 18:49:08 +0000 2009\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":false,\"lang\":null,\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"1A1B1F\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme9\\/bg.gif\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme9\\/bg.gif\",\"profile_background_tile\":true,\"profile_link_color\":\"F00505\",\"profile_sidebar_border_color\":\"070708\",\"profile_sidebar_fill_color\":\"848385\",\"profile_text_color\":\"050405\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/1208082874462855168\\/7fhikw8O_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/1208082874462855168\\/7fhikw8O_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/88245184\\/1542525099\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"retweeted_status\":{\"created_at\":\"Mon Apr 06 18:34:38 +0000 2020\",\"id\":1247231257118793729,\"id_str\":\"1247231257118793729\",\"text\":\"Coronavirus Jailbreak: Soros-Funded ACLU Helps Free Illegal Alien Child Molester, Immigrant Child Abuser - Trump Tr\\u2026 https:\\/\\/t.co\\/zUJPhnxNjf\",\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":true,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":1043270522295877632,\"id_str\":\"1043270522295877632\",\"name\":\"Redbeard (K) \\ud83c\\udf1f\\u2b50\\ufe0f\\ud83c\\udf1f\",\"screen_name\":\"lloyd4man\",\"location\":\"Santa Maria, CA\",\"url\":null,\"description\":\"i am the father of 6 daughters . i love my wife and family . Jesus Lover and love my President. MAGA , APATRIOT red-pilled Veteran USN TWGRP K.\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":70919,\"friends_count\":76603,\"listed_count\":42,\"favourites_count\":56318,\"statuses_count\":172652,\"created_at\":\"Fri Sep 21 22:47:30 +0000 2018\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":true,\"lang\":null,\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"F5F8FA\",\"profile_background_image_url\":\"\",\"profile_background_image_url_https\":\"\",\"profile_background_tile\":false,\"profile_link_color\":\"1DA1F2\",\"profile_sidebar_border_color\":\"C0DEED\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/1084669704659099648\\/wEamDG3T_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/1084669704659099648\\/wEamDG3T_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/1043270522295877632\\/1547440883\",\"default_profile\":true,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"extended_tweet\":{\"full_text\":\"Coronavirus Jailbreak: Soros-Funded ACLU Helps Free Illegal Alien Child Molester, Immigrant Child Abuser - Trump Train https:\\/\\/t.co\\/1mnGgyvrmR\",\"display_text_range\":[0,142],\"entities\":{\"hashtags\":[],\"urls\":[{\"url\":\"https:\\/\\/t.co\\/1mnGgyvrmR\",\"expanded_url\":\"https:\\/\\/www.trump-traiin.com\\/2020\\/04\\/coronavirus-jailbreak-soros-funded-aclu.html\",\"display_url\":\"trump-traiin.com\\/2020\\/04\\/corona\\u2026\",\"indices\":[119,142]}],\"user_mentions\":[],\"symbols\":[]}},\"quote_count\":0,\"reply_count\":0,\"retweet_count\":3,\"favorite_count\":1,\"entities\":{\"hashtags\":[],\"urls\":[{\"url\":\"https:\\/\\/t.co\\/zUJPhnxNjf\",\"expanded_url\":\"https:\\/\\/twitter.com\\/i\\/web\\/status\\/1247231257118793729\",\"display_url\":\"twitter.com\\/i\\/web\\/status\\/1\\u2026\",\"indices\":[117,140]}],\"user_mentions\":[],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\"},\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"lloyd4man\",\"name\":\"Redbeard (K) \\ud83c\\udf1f\\u2b50\\ufe0f\\ud83c\\udf1f\",\"id\":1043270522295877632,\"id_str\":\"1043270522295877632\",\"indices\":[3,13]}],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1586198435692\"}"
      val created1 = "2020-04-06"
      val location_filtered1 = "United States"
      val text1 = "coronavirus jailbreak sorosfunded aclu helps free illegal alien child molester immigrant abuser trump train https"

      val output1 =  s"""{created : \"$created1\" , location : \"$location_filtered1\" , text: \"$text1\"}"""


      val dataLine2 = "{\"created_at\":\"Mon Apr 06 18:40:34 +0000 2020\",\"id\":1247232750610010113,\"id_str\":\"1247232750610010113\",\"text\":\"RT @MarielMer1: Bueno, a m\\u00ed hermana le acaban de confirmar q no se pagar\\u00e1 el aumento previsto de aumento de paritaria (comercio), x la econ\\u2026\",\"source\":\"\\u003ca href=\\\"https:\\/\\/mobile.twitter.com\\\" rel=\\\"nofollow\\\"\\u003eTwitter Web App\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":1027662109402906627,\"id_str\":\"1027662109402906627\",\"name\":\"Claudio\",\"screen_name\":\"Clau_en_fuga_Z\",\"location\":null,\"url\":null,\"description\":\"Principado Aut\\u00f3nomo Aut\\u00e1rquico Anarquico Separatista de Lan\\u00fas\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":64,\"friends_count\":63,\"listed_count\":0,\"favourites_count\":19323,\"statuses_count\":3948,\"created_at\":\"Thu Aug 09 21:05:14 +0000 2018\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":false,\"lang\":null,\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"F5F8FA\",\"profile_background_image_url\":\"\",\"profile_background_image_url_https\":\"\",\"profile_background_tile\":false,\"profile_link_color\":\"1DA1F2\",\"profile_sidebar_border_color\":\"C0DEED\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/1192485291099148288\\/p_-Zfdei_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/1192485291099148288\\/p_-Zfdei_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/1027662109402906627\\/1533930435\",\"default_profile\":true,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"retweeted_status\":{\"created_at\":\"Mon Apr 06 17:47:06 +0000 2020\",\"id\":1247219295748268037,\"id_str\":\"1247219295748268037\",\"text\":\"Bueno, a m\\u00ed hermana le acaban de confirmar q no se pagar\\u00e1 el aumento previsto de aumento de paritaria (comercio), x\\u2026 https:\\/\\/t.co\\/4yHIHlu8qI\",\"source\":\"\\u003ca href=\\\"https:\\/\\/mobile.twitter.com\\\" rel=\\\"nofollow\\\"\\u003eTwitter Web App\\u003c\\/a\\u003e\",\"truncated\":true,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":944927054,\"id_str\":\"944927054\",\"name\":\"Mar\",\"screen_name\":\"MarielMer1\",\"location\":null,\"url\":null,\"description\":\"El gran ENIGMA de la vida ,definitivamente ,es el AMOR \\u2764\\n\\n\\nKeep your heels , head and standars high  !!!!! \\ud83d\\udc60\\ud83d\\udc46\\n\\nDesmitificando mitos \\ud83d\\ude09\\n\\nTe Amo Argentina \\ud83c\\udde6\\ud83c\\uddf7\\u2764\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":3601,\"friends_count\":3468,\"listed_count\":0,\"favourites_count\":90090,\"statuses_count\":55606,\"created_at\":\"Tue Nov 13 01:03:00 +0000 2012\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":false,\"lang\":null,\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"000000\",\"profile_background_image_url\":\"http:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_image_url_https\":\"https:\\/\\/abs.twimg.com\\/images\\/themes\\/theme1\\/bg.png\",\"profile_background_tile\":false,\"profile_link_color\":\"1B95E0\",\"profile_sidebar_border_color\":\"000000\",\"profile_sidebar_fill_color\":\"000000\",\"profile_text_color\":\"000000\",\"profile_use_background_image\":false,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/1235212745563426818\\/zPapDPJe_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/1235212745563426818\\/zPapDPJe_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/944927054\\/1585754623\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"extended_tweet\":{\"full_text\":\"Bueno, a m\\u00ed hermana le acaban de confirmar q no se pagar\\u00e1 el aumento previsto de aumento de paritaria (comercio), x la econom\\u00eda parada, el virus y coso \\ud83d\\ude12 pero para el bono de 10 lucas a la vagancia hubo ???\\nQuieren ahogar a los q trabajamos !!!!\",\"display_text_range\":[0,245],\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[],\"symbols\":[]}},\"quote_count\":2,\"reply_count\":6,\"retweet_count\":30,\"favorite_count\":62,\"entities\":{\"hashtags\":[],\"urls\":[{\"url\":\"https:\\/\\/t.co\\/4yHIHlu8qI\",\"expanded_url\":\"https:\\/\\/twitter.com\\/i\\/web\\/status\\/1247219295748268037\",\"display_url\":\"twitter.com\\/i\\/web\\/status\\/1\\u2026\",\"indices\":[117,140]}],\"user_mentions\":[],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"filter_level\":\"low\",\"lang\":\"es\"},\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"MarielMer1\",\"name\":\"Mar\",\"id\":944927054,\"id_str\":\"944927054\",\"indices\":[3,14]}],\"symbols\":[]},\"favorited\":false,\"retweeted\":false,\"filter_level\":\"low\",\"lang\":\"es\",\"timestamp_ms\":\"1586198434866\"}"
      val output2 = null

      assert(output1==SparkKafkaConnect.extractData(dataLine1))
      assert(output2==SparkKafkaConnect.extractData(dataLine2))
  }


}



